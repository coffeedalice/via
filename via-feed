#!/bin/bash

cache="$HOME/.cache/via"
system="$OSTYPE"

if [[ "$1" == "-r" ]] || [[ ! -e "$cache" ]]; then
	cat "$HOME/.config/via/shortcuts" > "$cache"
	cat "$HOME/.config/via/websites" >> "$cache"
	find "$HOME" -mindepth 1 \( -name ".*" -o -path "$HOME/code/*" \) -prune -o -print | sort >> "$cache"
fi

if [ "$system" == "linux-gnu"* ], then
  wmctrl -xl | sed "s/^[^.]*\.//;s/ \+\S\+ \+/ /;s/^/w /;s/ \+/ /g"
fi

cat "$cache"
